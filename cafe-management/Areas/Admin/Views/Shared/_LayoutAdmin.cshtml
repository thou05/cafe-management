@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    // Lấy tên Controller hiện tại từ URL
    var currentController = ViewContext.RouteData.Values["Controller"]?.ToString();

    string IsActive(string controllerName)
    {
        if (string.Equals(currentController, controllerName, StringComparison.OrdinalIgnoreCase))
        {
            // Thêm class 'server-active' để đánh dấu đây là cái do C# chọn
            return "active server-active";
        }
        return "";
    }
}


<!DOCTYPE html>
<html lang="vi">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>@ViewData["Title"] | ADMIN THE COFFEE HOUSE</title>
    <link rel="shortcut icon" href="~/favicon.ico" />

    <!--Font-->
    <link rel="stylesheet" type="text/css" href="~/css/style-font.css">

    <!--Bootstrap-->
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" type="text/css">

    <!--Font Awesome-->
    <link rel="stylesheet" href="~/lib/fontawesome/css/all.min.css" type="text/css">

    <!--JQuery-->
    <link rel="stylesheet" href="~/lib/jquery-ui/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="~/lib/magnific-popup/dist/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="~/lib/owl-carousel-2/dist/assets/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="~/lib/owl-carousel-2/dist/assets/owl.theme.default.min.css" type="text/css">
    <link rel="stylesheet" href="~/lib/slick-nav/dist/slicknav.min.css" type="text/css">


    <!--CSS-->
    <link rel="stylesheet" href="~/css/style-admin.css" type="text/css" asp-append-version="true">
    <link rel="stylesheet" href="~/css/style-admin-additional.css" type="text/css" asp-append-version="true">
    <link rel="stylesheet" href="~/css/admin-custom.css" />
</head>
<body>
    <div class="container-scroller">
        <nav class="navbar default-layout-navbar col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
            <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-center">
                <a asp-controller="homeadmin" asp-action="index" class="admin__logo">
                    <i class="fas fa-coffee"></i>
                    | Admin
                </a>
            </div>
            <div class="navbar-menu-wrapper d-flex align-items-stretch">
                <ul class="navbar-nav navbar-nav-right">
                    <li class="nav-item nav-item-logout">
                        <a asp-controller="access" asp-action="logout" class="nav-link">
                            <i class="fas fa-sign-out-alt"></i>
                            <span class="menu-title" style="padding-left:10px;">Logout</span>
                        </a>
                    </li>
                </ul>
                <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" onclick="openNavbar()">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>

        <div class="container-fluid page-body-wrapper">
            
            <nav class="sidebar sidebar-offcanvas" id="sidebar">
                <ul class="nav nav-bar-fixed">
                    <li class="nav-item @IsActive("HomeAdmin")">
                        <a asp-controller="HomeAdmin" asp-action="Index" class="nav-link">
                            <i class="fas fa-list-ul"></i> <span class="menu-title">Product</span>
                        </a>
                    </li>

                    <li class="nav-item @IsActive("Categories")">
                        <a asp-controller="Categories" asp-action="Index" class="nav-link">
                            <i class="fas fa-table"></i>
                            <span class="menu-title">Category</span>
                        </a>
                    </li>

                    <li class="nav-item @IsActive("Bill")">
                        <a asp-controller="Bill" asp-action="Index" class="nav-link">
                            <i class="fas fa-file-invoice"></i>
                            <span class="menu-title">Bill</span>
                        </a>
                    </li>

                    <li class="nav-item @IsActive("Customers")">
                        <a asp-controller="Customers" asp-action="Index" class="nav-link">
                            <i class="fas fa-user"></i>
                            <span class="menu-title">Customer</span>
                        </a>
                    </li>

                    <li class="nav-item @IsActive("NewsManage")">
                        <a asp-controller="NewsManage" asp-action="Index" class="nav-link">
                            <i class="fas fa-newspaper"></i>
                            <span class="menu-title">News</span>
                        </a>
                    </li>

                    <li class="nav-item @IsActive("Feedback")">
                        <a asp-controller="Feedback" asp-action="Index" class="nav-link">
                            <i class="fas fa-comments"></i>
                            <span class="menu-title">Feedback</span>
                        </a>
                    </li>

                    <li class="nav-item @IsActive("Accounts")">
                        <a asp-controller="Accounts" asp-action="Index" class="nav-link">
                            <i class="fas fa-lock"></i>
                            <span class="menu-title">Account</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a asp-controller="Access" asp-action="Logout" class="nav-link">
                            <i class="fas fa-sign-out-alt"></i>
                            <span class="menu-title">Logout</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="main-panel">
                <div class="content-wrapper">
                    <div class="row">
                        @RenderBody()
                    </div>
                </div>

                <footer class="footer">
                    <div class="container-fluid">
                        <div class="row">
                            <span class="copyright_text">
                                Bản quyền &copy;
                                <script>document.write(new Date().getFullYear());</script>.
                                <a asp-controller="home" asp-action="index">THE COFFEE HOUSE</a>
                            </span>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
    </div>
    <!-- container-scroller -->
    <!--JS Begin-->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>

    <!--Bootstrap-->
    <script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>

    <!--Font Awesome-->
    <script src="~/lib/fontawesome/js/all.min.js"></script>

    <script src="~/js/off-canvas.js"></script>
    <script src="~/js/hoverable-collapse.js"></script>
    <script src="~/js/misc.js"></script>
    <script src="~/js/main-admin.js" asp-append-version="true"></script>
    <script src="~/js/main-admin-additional.js" asp-append-version="true"></script>

    <script>
        $(document).ready(function () {
            // Đợi 100ms để đảm bảo JS của template chạy xong việc thêm class lung tung
            setTimeout(function() {

                // 1. Tìm cái thẻ li nào có class 'server-active' (Cái đúng)
                var trueActive = $(".nav-item.server-active");

                // 2. Nếu tìm thấy cái đúng
                if (trueActive.length > 0) {
                    // Xóa class 'active' ở TẤT CẢ các thẻ li KHÁC
                    $(".nav-item").not(trueActive).removeClass("active");

                    // Đảm bảo cái đúng vẫn còn class active (đề phòng bị JS template xóa nhầm)
                    trueActive.addClass("active");
                }
                else {
                    // Trường hợp C# không tìm thấy controller nào khớp (ví dụ trang lạ),
                    // thì cho phép JS template tự quyết định hoặc xóa hết tùy bạn.
                    // Ở đây ta xóa hết cho sạch.
                     $(".nav-item").removeClass("active");
                }
            }, 100);
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>






